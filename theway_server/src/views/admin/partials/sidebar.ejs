<div class="admin-sidebar bg-dark text-white" style="width: 250px; min-height: 100vh;">
    <!-- Logo -->
    <div class="sidebar-header p-3 border-bottom border-secondary">
        <h4 class="mb-0">
            <i class="bi bi-controller me-2"></i>
            Way3 Admin
        </h4>
    </div>

    <!-- Navigation Menu -->
    <nav class="sidebar-nav">
        <ul class="nav flex-column">
            <!-- Dashboard -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath === '/admin' || currentPath === '/admin/' ? 'active bg-primary' : '' %>"
                   href="/admin">
                    <i class="bi bi-speedometer2 me-2"></i>
                    대시보드
                </a>
            </li>

            <!-- 상인 관리 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/merchants') ? 'active bg-primary' : '' %>"
                   href="/admin/merchants">
                    <i class="bi bi-shop me-2"></i>
                    상인 관리
                    <span class="badge bg-secondary ms-auto" id="merchantCount">-</span>
                </a>
            </li>

            <!-- 미디어 관리 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/media') ? 'active bg-primary' : '' %>"
                   href="/admin/media">
                    <i class="bi bi-image me-2"></i>
                    미디어 관리
                    <span class="badge bg-info ms-auto" id="mediaCount">-</span>
                </a>
            </li>

            <!-- 퀘스트 관리 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/quests') ? 'active bg-primary' : '' %>"
                   href="/admin/quests">
                    <i class="bi bi-flag me-2"></i>
                    퀘스트 관리
                    <span class="badge bg-warning ms-auto" id="questCount">-</span>
                </a>
            </li>

            <!-- 스킬 관리 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/skills') ? 'active bg-primary' : '' %>"
                   href="/admin/skills">
                    <i class="bi bi-lightning me-2"></i>
                    스킬 관리
                    <span class="badge bg-success ms-auto" id="skillCount">-</span>
                </a>
            </li>

            <!-- 플레이어 관리 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/players') ? 'active bg-primary' : '' %>"
                   href="/admin/players">
                    <i class="bi bi-people me-2"></i>
                    플레이어 관리
                    <span class="badge bg-danger ms-auto" id="playerCount">-</span>
                </a>
            </li>

            <hr class="border-secondary my-3">

            <!-- 모니터링 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/monitoring') ? 'active bg-primary' : '' %>"
                   href="/admin/monitoring">
                    <i class="bi bi-bar-chart me-2"></i>
                    모니터링
                </a>
            </li>

            <!-- 시스템 설정 -->
            <li class="nav-item">
                <a class="nav-link text-white <%= currentPath.startsWith('/admin/settings') ? 'active bg-primary' : '' %>"
                   href="/admin/settings">
                    <i class="bi bi-gear me-2"></i>
                    시스템 설정
                </a>
            </li>

            <hr class="border-secondary my-3">

            <!-- 게임으로 돌아가기 -->
            <li class="nav-item">
                <a class="nav-link text-white-50" href="/" target="_blank">
                    <i class="bi bi-box-arrow-up-right me-2"></i>
                    게임 보기
                </a>
            </li>

            <!-- 로그아웃 -->
            <li class="nav-item">
                <a class="nav-link text-white-50" href="/admin/logout"
                   onclick="return confirm('로그아웃 하시겠습니까?')">
                    <i class="bi bi-box-arrow-right me-2"></i>
                    로그아웃
                </a>
            </li>
        </ul>
    </nav>

    <!-- System Status -->
    <div class="sidebar-footer p-3 mt-auto border-top border-secondary">
        <div class="small text-white-50">
            <div class="d-flex justify-content-between">
                <span>서버 상태</span>
                <span class="text-success">
                    <i class="bi bi-circle-fill" style="font-size: 0.5rem;"></i>
                    Online
                </span>
            </div>
            <div class="d-flex justify-content-between mt-1">
                <span>DB</span>
                <span class="text-success" id="dbStatus">Connected</span>
            </div>
        </div>
    </div>
</div>

<style>
.admin-sidebar .nav-link {
    padding: 0.75rem 1rem;
    transition: all 0.2s;
}

.admin-sidebar .nav-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.admin-sidebar .nav-link.active {
    background-color: #0d6efd !important;
}

.sidebar-footer {
    position: sticky;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.2);
}

.badge {
    font-size: 0.6rem;
    padding: 0.2rem 0.4rem;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 사이드바 카운트 업데이트
    updateSidebarCounts();

    // 5분마다 카운트 업데이트
    setInterval(updateSidebarCounts, 300000);
});

async function updateSidebarCounts() {
    try {
        const response = await fetch('/admin/api/dashboard/counts');
        const data = await response.json();

        if (data.success) {
            document.getElementById('merchantCount').textContent = data.data.merchants || '-';
            document.getElementById('mediaCount').textContent = data.data.media || '-';
            document.getElementById('questCount').textContent = data.data.quests || '-';
            document.getElementById('skillCount').textContent = data.data.skills || '-';
            document.getElementById('playerCount').textContent = data.data.players || '-';
        }
    } catch (error) {
        console.warn('Failed to update sidebar counts:', error);
    }
}
</script>